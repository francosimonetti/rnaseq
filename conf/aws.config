process {
    executor = 'awsbatch'
    queue = 'nf-job-queue'
    scratch = '/mnt/efs/fs1/tmp'
}

aws {
    region = 'us-east-1'
    batch {
      cliPath = '/home/ec2-user/miniconda/bin/aws'
      volumes = '/mnt/efs/fs1'
      maxParallelTransfers = 20
    }
    client.maxConnections = 20
}

// How to create SRA list file
// aws s3 ls s3://fsimonetti-sra | grep SRR | awk '{ print $2}' | sed 's/\///g' > SRR_list.txt
// for s in `cat SRR_list.txt` ; do echo -e "${s}\ts3://fsimonetti-sra/${s}/${s}" >> GTEx_SRA_S3paths.txt; done

params {
  // Input data
  readPathsFile = "s3://fsimonetti-nfdata/input/GTEx_SRA_S3paths.txt"
  // Genome references
  unstranded = true
  outdir = "s3://fsimonetti-nfdata/outdir_GTEx_test"
  //workdir = "s3://fsimonetti-nfdata/workdir"

  run_ge_quant = true
  run_salmon = true
  run_txrevise = false
  run_leafcutter = false
  run_exon_quant = true
  mbv_vcf = "s3://fsimonetti-nfdata/GTEx/GTEX_v8_2020-02-21_WGS_838Indiv_Freeze.SHAPEIT2_phased_NoMissingGT_SNPfilter_MAF0.01_chr22.vcf.gz"
  mbv_vcf_index = "s3://fsimonetti-nfdata/GTEx/GTEX_v8_2020-02-21_WGS_838Indiv_Freeze.SHAPEIT2_phased_NoMissingGT_SNPfilter_MAF0.01_chr22.vcf.gz.tbi"
  run_mbv = true

  saveReference = false
  saveTrimmed = false
  saveAlignedIntermediates = true
  saveIndividualQuants = true
  saveInfoLogs = true

}

trace {
  overwrite = true
}

dag {
 overwrite = true
}

timeline {
 overwrite = true
}

report {
 overwrite = true
}
